{% extends "base.html" %}
{% block content %}
<h2>Edit Day: {{ day.day_name }} — {{ program.name }}</h2>

{% if program.locked %}
  <div class="card">
    <p class="muted">Program is started and locked. Editing is disabled.</p>
    <a class="btn" href="{{ url_for('current_program') }}">Back</a>
  </div>
{% else %}
  <div class="card">
    <h3>Add Exercise</h3>
    <form method="post" class="grid2">
      <div>
        <label>Exercise</label>
        <select name="exercise_id">
          {% for ex in bank %}
            <option value="{{ ex.id }}">{{ ex.muscle_group }} — {{ ex.name }}</option>
          {% endfor %}
        </select>
      </div>

      <div>
        <label>Target sets</label>
        <input name="target_sets" type="number" min="1" value="3">
      </div>

      <div>
        <label>Rep range (min → max)</label>
        <div class="row gap">
          <input name="rep_min" type="number" min="1" value="8" class="w80"> 
          <span class="muted">to</span>
          <input name="rep_max" type="number" min="1" value="10" class="w80">
        </div>
      </div>

      <div>
        <label>RIR</label>
        <select name="rir">
          <option {% if program.target_rir==0 %}selected{% endif %}>0</option>
          <option {% if program.target_rir==1 %}selected{% endif %}>1</option>
          <option {% if program.target_rir==2 %}selected{% endif %}>2</option>
          <option {% if program.target_rir==3 %}selected{% endif %}>3</option>
        </select>
      </div>

      <div class="col-span-2">
        <button class="btn-primary" type="submit">Add to Day</button>
      </div>
    </form>
  </div>

  <div class="card">
    <h3>Current Exercises</h3>
    {% if pes %}
      <ul class="bullets">
        {% for pe in pes %}
          <li class="row">
            <span>{{ pe.exercise.name }} — {{ pe.target_sets }} sets @ {{ pe.rep_min }}–{{ pe.rep_max }} (RIR {{ pe.rir }})</span>
            <form method="post" action="{{ url_for('delete_program_exercise', pe_id=pe.id) }}">
              <button class="btn danger" type="submit">Remove</button>
            </form>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p class="muted">None yet — add some above.</p>
    {% endif %}
    <p><a class="btn" href="{{ url_for('current_program') }}">← Back to Current Program</a></p>
  </div>
{% endif %}
{% endblock %}
